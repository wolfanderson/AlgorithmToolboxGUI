# 图片上传问题排查指南

## 已添加的功能

1. **详细的控制台日志** - 前端和后端都会输出详细的调试信息
2. **拖拽上传** - 可以直接拖拽图片到预览区域
3. **错误提示** - 更详细的错误信息

## 排查步骤

### 1. 检查浏览器控制台

打开浏览器开发者工具（F12），查看 Console 标签页，上传图片时应该看到：
- "开始上传文件: xxx"
- "发送上传请求到 /api/upload"
- "响应状态: 200 OK"
- "服务器响应: {...}"

### 2. 检查服务器终端

在运行 `python app.py` 的终端中，上传时应该看到：
- "收到上传请求，方法: POST"
- "文件名: xxx"
- "保存文件到: xxx"
- "上传成功: xxx"

### 3. 常见问题

#### 问题1: 控制台显示 "网络错误" 或 "Failed to fetch"
**原因**: 服务器未运行或端口不对
**解决**: 
- 确保运行了 `python app.py`
- 确保访问的是 `http://localhost:5000`

#### 问题2: 控制台显示 "没有文件"
**原因**: FormData 字段名不匹配
**解决**: 检查前端代码中 `formData.append('file', file)` 是否正确

#### 问题3: 文件保存失败
**原因**: 权限问题或磁盘空间不足
**解决**: 
- 检查 `uploads/` 目录是否存在
- 检查是否有写入权限

#### 问题4: 文件类型不支持
**原因**: 文件扩展名不在允许列表中
**解决**: 确保上传的是图片文件（png, jpg, jpeg, gif, bmp, tiff, webp）

## 测试方法

1. **点击上传按钮**
   - 点击"上传图片"按钮
   - 选择图片文件
   - 查看控制台输出

2. **拖拽上传**
   - 直接拖拽图片文件到右侧预览区域的"输入图像"框
   - 应该看到边框高亮
   - 松开鼠标完成上传

3. **检查文件**
   - 上传成功后，检查项目目录下的 `uploads/` 文件夹
   - 应该能看到上传的文件（文件名格式：时间戳_原文件名）

## 如果仍然无法上传

请提供以下信息：
1. 浏览器控制台的完整错误信息
2. 服务器终端的输出
3. 使用的浏览器和版本
4. 上传的文件类型和大小

